<!doctype html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>예제 문서</title>
	</head>
	<body>
		<h1>UPPERSITE CRUD Example</h1>
		<form>
			<h3>Article Form</h3>
			<p>
				<input name="title" placeholder="Article Title.">
			</p>
			<p>
				<textarea name="content" placeholder="Article Content."></textarea>
			</p>
			<p>
				<input type="submit">
			</p>
		</form>
		<table border='1px'>
			<thead>
				<th>제목</th>
				<th>내용</th>
				<th>작성일자</th>
			</thead>
			<tbody>

			</tbody>
		</table>
		<script src="/__SCRIPT"></script>
		<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
		<script>
			var
			// article model
			articleModel = CRUDExample.ArticleModel();

			articleModel.findDataSet({
				sort : {
					createTime : -1
				}
			}, function(result) {

				if (result.hasError === false) {

					EACH(result.savedDataSet, function(data) {
						$('tbody').append('<tr id=' + data.id + '>');
						$('#' + data.id).append('<td class=title>' + data.title + '</td>');
						$('#' + data.id).append('<td class=content>' + data.content + '</td>');
						$('#' + data.id).append('<td class=time>' + data.createTime + '</td></tr>');
					});
				}
			});

			articleModel.onNew(function(savedData) {
				$('tbody').before('<tr id=' + savedData.id + '>');
				$('#' + savedData.id).append('<td class=title>' + savedData.title + '</td>');
				$('#' + savedData.id).append('<td class=content>' + savedData.content + '</td>');
				$('#' + savedData.id).append('<td class=time>' + savedData.createTime + '</td></tr>');
			});

			$('form').submit(function() {

				var
				// data
				data = {};

				$.each($(this).serializeArray(), function(i, o) {
					data[o.name] = o.value;
				});

				articleModel.create(data, function(result) {

					if (result.hasError === false) {
						alert('Success.');
					} else {
						alert(JSON.stringify(result.errors));
					}
				});

				return false;
			});
		</script>
	</body>
</html>